<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1010px" preserveAspectRatio="none" style="width:892px;height:1010px;" version="1.1" viewBox="0 0 892 1010" width="892px" zoomAndPan="magnify"><defs><filter height="300%" id="fzztn0u7cm5zz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="392.5" y="23.1318">load_defaults</text><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="210.5" y="132.1973"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="575.9233" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="384.5" y="361.7871"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="127.6924" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="375.7871"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="52.9487" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="732" y="646.1206"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="66" x2="66" y1="116.1973" y2="998.6592"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="215" x2="215" y1="116.1973" y2="998.6592"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="389" x2="389" y1="116.1973" y2="998.6592"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="558" x2="558" y1="116.1973" y2="998.6592"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="737" x2="737" y1="116.1973" y2="998.6592"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="8" y="113.2305">my_load_defaults</text><ellipse cx="66.5" cy="43.0986" fill="#FEFECE" filter="url(#fzztn0u7cm5zz)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M66.5,51.0986 L66.5,78.0986 M53.5,59.0986 L79.5,59.0986 M66.5,78.0986 L53.5,93.0986 M66.5,78.0986 L79.5,93.0986 " fill="none" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fzztn0u7cm5zz)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="135" y="81.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="142" y="101.2305">init_default_directories</text><rect fill="#FEFECE" filter="url(#fzztn0u7cm5zz)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="306" y="81.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="313" y="101.2305">my_search_option_files</text><rect fill="#FEFECE" filter="url(#fzztn0u7cm5zz)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="483" y="81.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="490" y="101.2305">get_defaults_options</text><rect fill="#FEFECE" filter="url(#fzztn0u7cm5zz)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="643" y="81.0986"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="650" y="101.2305">init_variable_default_paths</text><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="210.5" y="132.1973"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="575.9233" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="384.5" y="361.7871"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="127.6924" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="375.7871"/><rect fill="#FFFFFF" filter="url(#fzztn0u7cm5zz)" height="52.9487" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="732" y="646.1206"/><polygon fill="#A80036" points="198.5,128.1973,208.5,132.1973,198.5,136.1973,202.5,132.1973" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="66.5" x2="204.5" y1="132.1973" y2="132.1973"/><path d="M220,175.1973 L220,289.1973 L398,289.1973 L398,185.1973 L388,175.1973 L220,175.1973 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M388,175.1973 L388,185.1973 L398,185.1973 L388,175.1973 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="226" y="192.3911">char **dirs ={</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="226" y="207.3398">"/etc/"",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="226" y="222.2886">"/etc/mysql/",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="226" y="237.2373">DEFAULT_SYSCONFDIR,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="226" y="252.186">env(MYSQL_HOME),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="14" x="226" y="267.1348">"",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="14" x="226" y="282.0835">""}</text><polygon fill="#A80036" points="77.5,300.8384,67.5,304.8384,77.5,308.8384,73.5,304.8384" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71.5" x2="214.5" y1="304.8384" y2="304.8384"/><rect fill="#EEEEEE" filter="url(#fzztn0u7cm5zz)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="877" x="3" y="333.3127"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="880" y1="333.3127" y2="333.3127"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="880" y1="336.3127" y2="336.3127"/><rect fill="#EEEEEE" filter="url(#fzztn0u7cm5zz)" height="22.9487" style="stroke: #000000; stroke-width: 2.0;" width="177" x="353" y="322.8384"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="359" y="339.0322">my_search_option_files</text><polygon fill="#A80036" points="372.5,357.7871,382.5,361.7871,372.5,365.7871,376.5,361.7871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="66.5" x2="378.5" y1="361.7871" y2="361.7871"/><polygon fill="#A80036" points="541,371.7871,551,375.7871,541,379.7871,545,375.7871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="547" y1="375.7871" y2="375.7871"/><path d="M568,388.7871 L568,487.7871 L734,487.7871 L734,398.7871 L724,388.7871 L568,388.7871 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M724,388.7871 L724,398.7871 L734,398.7871 L724,388.7871 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="574" y="405.981">检查这几个输入参数，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="574" y="420.9297">"--no-defaults",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="574" y="435.8784">"--defaults-file=",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="574" y="450.8271">"--defaults-extra-file=",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="574" y="465.7759">"--defaults-group-suffix=",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="574" y="480.7246">"--login-path="</text><polygon fill="#A80036" points="405.5,499.4795,395.5,503.4795,405.5,507.4795,401.5,503.4795" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="557" y1="503.4795" y2="503.4795"/><path d="M399,516.4795 L399,630.4795 L591,630.4795 L591,526.4795 L581,516.4795 L399,516.4795 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M581,516.4795 L581,526.4795 L591,526.4795 L581,516.4795 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="405" y="533.6733">根据检查入口参数， 来设置</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="405" y="548.6221">my_defaults_group_suffix,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="405" y="563.5708">my_defaults_extra_file,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="405" y="578.5195">my_defaults_extra_file_buffer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="405" y="593.4683">my_defaults_file,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="405" y="608.417">my_defaults_file_buffer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="405" y="623.3657">defaults_already_read=true</text><polygon fill="#A80036" points="720,642.1206,730,646.1206,720,650.1206,724,646.1206" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="726" y1="646.1206" y2="646.1206"/><path d="M747,659.1206 L747,683.1206 L871,683.1206 L871,669.1206 L861,659.1206 L747,659.1206 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M861,659.1206 L861,669.1206 L871,669.1206 L861,659.1206 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="753" y="676.3145">设置default_paths</text><polygon fill="#A80036" points="405.5,695.0693,395.5,699.0693,405.5,703.0693,401.5,699.0693" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="736" y1="699.0693" y2="699.0693"/><path d="M399,712.0693 L399,736.0693 L739,736.0693 L739,722.0693 L729,712.0693 L399,712.0693 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M729,712.0693 L729,722.0693 L739,722.0693 L729,712.0693 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="405" y="729.2632">如果设置了my_defaults_group_suffix， 则设置一些东西</text><path d="M399,751.0181 L399,775.0181 L677,775.0181 L677,761.0181 L667,751.0181 L399,751.0181 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M667,751.0181 L667,761.0181 L677,761.0181 L667,751.0181 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="405" y="768.2119">如果设置了my_login_path， 则设置一些东西</text><path d="M399,789.9668 L399,813.9668 L721,813.9668 L721,799.9668 L711,789.9668 L399,789.9668 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M711,789.9668 L711,799.9668 L721,799.9668 L711,789.9668 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="405" y="807.1606">如果conf_file是觉得路径， 则调用search_default_file</text><path d="M399,828.9155 L399,852.9155 L796,852.9155 L796,838.9155 L786,828.9155 L399,828.9155 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M786,828.9155 L786,838.9155 L796,838.9155 L786,828.9155 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="405" y="846.1094">如果设置了my_defaults_file， 则调用search_default_file_with_ext</text><path d="M399,867.8643 L399,921.8643 L769,921.8643 L769,877.8643 L759,867.8643 L399,867.8643 " fill="#FBFB77" filter="url(#fzztn0u7cm5zz)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M759,867.8643 L759,877.8643 L769,877.8643 L759,867.8643 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="405" y="885.0581">如果设置了found_no_defaults， 从上一步得到的6个目录中，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="405" y="900.0068">调用search_default_file/search_default_file_with_ext，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="409" y="914.9556">搜索my.conf/my_defaults_extra_file</text><polygon fill="#A80036" points="77.5,933.7104,67.5,937.7104,77.5,941.7104,73.5,937.7104" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71.5" x2="388.5" y1="937.7104" y2="937.7104"/><rect fill="#EEEEEE" filter="url(#fzztn0u7cm5zz)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="877" x="3" y="966.1848"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="880" y1="966.1848" y2="966.1848"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="880" y1="969.1848" y2="969.1848"/><rect fill="#EEEEEE" filter="url(#fzztn0u7cm5zz)" height="22.9487" style="stroke: #000000; stroke-width: 2.0;" width="53" x="415" y="955.7104"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="34" x="421" y="971.9043">other</text><!--
@startuml
hide footbox
title load_defaults

actor my_load_defaults as load
participant init_default_directories 
participant my_search_option_files
participant get_defaults_options
participant init_variable_default_paths


load -> init_default_directories
activate init_default_directories
note right of init_default_directories: char **dirs ={\n"/etc/"", \n"/etc/mysql/", \nDEFAULT_SYSCONFDIR, \nenv(MYSQL_HOME), \n"", \n"~\""}
deactivate init_default_directories
init_default_directories -> load

== my_search_option_files == 
load -> my_search_option_files
activate my_search_option_files

my_search_option_files -> get_defaults_options
activate get_defaults_options
note right of get_defaults_options: 检查这几个输入参数，\n"- -no-defaults", \n"- -defaults-file=", \n"- -defaults-extra-file=", \n"- -defaults-group-suffix=",\n"- -login-path="

get_defaults_options ->my_search_option_files
deactivate get_defaults_options

note right of my_search_option_files: 根据检查入口参数， 来设置\nmy_defaults_group_suffix,\nmy_defaults_extra_file, \nmy_defaults_extra_file_buffer,\nmy_defaults_file,\nmy_defaults_file_buffer,\ndefaults_already_read=true

my_search_option_files -> init_variable_default_paths
activate init_variable_default_paths

note right of init_variable_default_paths: 设置default_paths

init_variable_default_paths -> my_search_option_files
deactivate init_variable_default_paths

note right of my_search_option_files: 如果设置了my_defaults_group_suffix， 则设置一些东西
note right of my_search_option_files: 如果设置了my_login_path， 则设置一些东西
note right of my_search_option_files: 如果conf_file是觉得路径， 则调用search_default_file
note right of my_search_option_files: 如果设置了my_defaults_file， 则调用search_default_file_with_ext
note right of my_search_option_files: 如果设置了found_no_defaults， 从上一步得到的6个目录中，\n调用search_default_file/search_default_file_with_ext，\n 搜索my.conf/my_defaults_extra_file





my_search_option_files -> load
deactivate my_search_option_files

== other == 
@enduml

PlantUML version 1.2019.03(Sun Mar 10 19:04:44 CST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_161-b14
Operating System: Linux
OS Version: 3.10.0-327.22.2.el7.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>